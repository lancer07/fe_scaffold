/*! WebUploader 0.1.5 */
(function(f,d){var c={},b=function(o,p){var m,l,n;if(typeof o==="string"){return e(o)}else{m=[];for(l=o.length,n=0;n<l;n++){m.push(e(o[n]))}return p.apply(null,m)}},k=function(n,m,l){if(arguments.length===2){l=m;m=null}b(m||[],function(){j(n,l,arguments)})},j=function(p,l,m){var n={exports:l},o;if(typeof l==="function"){m.length||(m=[b,n.exports,n]);o=l.apply(null,m);o!==undefined&&(n.exports=o)}c[p]=n.exports},e=function(m){var l=c[m]||f[m];if(!l){throw new Error("`"+m+"` is undefined")}return l},h=function(r){var m,p,q,l,o,n;n=function(s){return s&&(s.charAt(0).toUpperCase()+s.substr(1))};for(m in c){p=r;if(!c.hasOwnProperty(m)){continue}q=m.split("/");o=n(q.pop());while((l=n(q.shift()))){p[l]=p[l]||{};p=p[l]}p[o]=c[m]}return r},a=function(l){f.__dollar=l;return h(d(f,k,b))},g;if(typeof module==="object"&&typeof module.exports==="object"){module.exports=a()}else{if(typeof define==="function"&&define.amd){if(typeof jQuery=="undefined"){}else{g=f.WebUploader;f.WebUploader=a();f.WebUploader.noConflict=function(){f.WebUploader=g}}}else{g=f.WebUploader;f.WebUploader=a();f.WebUploader.noConflict=function(){f.WebUploader=g}}}})(window,function(b,c,a){c("dollar-third",[],function(){var d=b.__dollar||b.jQuery||b.Zepto;if(!d){throw new Error("jQuery or Zepto not found!")}return d});c("dollar",["dollar-third"],function(d){return d});c("promise-third",["dollar"],function(d){return{Deferred:d.Deferred,when:d.when,isPromise:function(e){return e&&typeof e.then==="function"}}});c("promise",["promise-third"],function(d){return d});c("base",["dollar","promise"],function(h,k){var g=function(){},f=Function.call;function e(l){return function(){return f.apply(l,arguments)}}function j(m,l){return function(){return m.apply(l,arguments)}}function d(l){var m;if(Object.create){return Object.create(l)}else{m=function(){};m.prototype=l;return new m()}}return{version:"0.1.5",$:h,Deferred:k.Deferred,isPromise:k.isPromise,when:k.when,browser:(function(p){var o={},n=p.match(/WebKit\/([\d.]+)/),l=p.match(/Chrome\/([\d.]+)/)||p.match(/CriOS\/([\d.]+)/),s=p.match(/MSIE\s([\d\.]+)/)||p.match(/(?:trident)(?:.*rv:([\w.]+))?/i),q=p.match(/Firefox\/([\d.]+)/),r=p.match(/Safari\/([\d.]+)/),m=p.match(/OPR\/([\d.]+)/);n&&(o.webkit=parseFloat(n[1]));l&&(o.chrome=parseFloat(l[1]));s&&(o.ie=parseFloat(s[1]));q&&(o.firefox=parseFloat(q[1]));r&&(o.safari=parseFloat(r[1]));m&&(o.opera=parseFloat(m[1]));return o})(navigator.userAgent),os:(function(n){var m={},l=n.match(/(?:Android);?[\s\/]+([\d.]+)?/),o=n.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);l&&(m.android=parseFloat(l[1]));o&&(m.ios=parseFloat(o[1].replace(/_/g,".")));return m})(navigator.userAgent),inherits:function(n,m,l){var o;if(typeof m==="function"){o=m;m=null}else{if(m&&m.hasOwnProperty("constructor")){o=m.constructor}else{o=function(){return n.apply(this,arguments)}}}h.extend(true,o,n,l||{});o.__super__=n.prototype;o.prototype=d(n.prototype);m&&h.extend(true,o.prototype,m);return o},noop:g,bindFn:j,log:(function(){if(b.console){return j(console.log,console)}return g})(),nextTick:(function(){return function(l){setTimeout(l,1)}})(),slice:e([].slice),guid:(function(){var l=0;return function(o){var m=(+new Date()).toString(32),n=0;for(;n<5;n++){m+=Math.floor(Math.random()*65535).toString(32)}return(o||"wu_")+m+(l++).toString(32)}})(),formatSize:function(n,l,m){var o;m=m||["B","K","M","G","TB"];while((o=m.shift())&&n>1024){n=n/1024}return(o==="B"?n:n.toFixed(l||2))+o}}});c("mediator",["base"],function(f){var g=f.$,l=[].slice,k=/\s+/,e;function d(m,n,p,o){return g.grep(m,function(q){return q&&(!n||q.e===n)&&(!p||q.cb===p||q.cb._cb===p)&&(!o||q.ctx===o)})}function j(m,o,n){g.each((m||"").split(k),function(p,q){n(q,o)})}function h(q,o){var n=false,p=-1,m=q.length,r;while(++p<m){r=q[p];if(r.cb.apply(r.ctx2,o)===false){n=true;break}}return !n}e={on:function(m,q,n){var o=this,p;if(!q){return this}p=this._events||(this._events=[]);j(m,q,function(r,t){var s={e:r};s.cb=t;s.ctx=n;s.ctx2=n||o;s.id=p.length;p.push(s)});return this},once:function(m,p,n){var o=this;if(!p){return o}j(m,p,function(q,s){var r=function(){o.off(q,r);return s.apply(n||o,arguments)};r._cb=s;o.on(q,r,n)});return o},off:function(o,m,n){var p=this._events;if(!p){return this}if(!o&&!m&&!n){this._events=[];return this}j(o,m,function(r,q){g.each(d(p,r,q,n),function(){delete p[this.id]})});return this},trigger:function(p){var n,o,m;if(!this._events||!p){return this}n=l.call(arguments,1);o=d(this._events,p);m=d(this._events,"all");return h(o,n)&&h(m,arguments)}};return g.extend({installTo:function(m){return g.extend(m,e)}},e)});c("uploader",["base","mediator"],function(d,f){var e=d.$;function g(h){this.options=e.extend(true,{},g.options,h);this._init(this.options)}g.options={};f.installTo(g.prototype);e.each({upload:"start-upload",stop:"stop-upload",getFile:"get-file",getFiles:"get-files",addFile:"add-file",addFiles:"add-file",sort:"sort-files",removeFile:"remove-file",cancelFile:"cancel-file",skipFile:"skip-file",retry:"retry",isInProgress:"is-in-progress",makeThumb:"make-thumb",md5File:"md5-file",getDimension:"get-dimension",addButton:"add-btn",predictRuntimeType:"predict-runtime-type",refresh:"refresh",disable:"disable",enable:"enable",reset:"reset"},function(h,j){g.prototype[h]=function(){return this.request(j,arguments)
}});e.extend(g.prototype,{state:"pending",_init:function(j){var h=this;h.request("init",j,function(){h.state="ready";h.trigger("ready")})},option:function(h,k){var j=this.options;if(arguments.length>1){if(e.isPlainObject(k)&&e.isPlainObject(j[h])){e.extend(j[h],k)}else{j[h]=k}}else{return h?j[h]:j}},getStats:function(){var h=this.request("get-stats");return h?{successNum:h.numOfSuccess,progressNum:h.numOfProgress,cancelNum:h.numOfCancel,invalidNum:h.numOfInvalid,uploadFailNum:h.numOfUploadFailed,queueNum:h.numOfQueue,interruptNum:h.numofInterrupt}:{}},trigger:function(k){var j=[].slice.call(arguments,1),l=this.options,h="on"+k.substring(0,1).toUpperCase()+k.substring(1);if(f.trigger.apply(this,arguments)===false||e.isFunction(l[h])&&l[h].apply(this,j)===false||e.isFunction(this[h])&&this[h].apply(this,j)===false||f.trigger.apply(f,[this,k].concat(j))===false){return false}return true},destroy:function(){this.request("destroy",arguments);this.off()},request:d.noop});d.create=g.create=function(h){return new g(h)};d.Uploader=g;return g});c("runtime/runtime",["base","mediator"],function(e,h){var g=e.$,f={},j=function(l){for(var k in l){if(l.hasOwnProperty(k)){return k}}return null};function d(k){this.options=g.extend({container:document.body},k);this.uid=e.guid("rt_")}g.extend(d.prototype,{getContainer:function(){var m=this.options,l,k;if(this._container){return this._container}l=g(m.container||document.body);k=g(document.createElement("div"));k.attr("id","rt_"+this.uid);k.css({position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"});l.append(k);l.addClass("webuploader-container");this._container=k;this._parent=l;return k},init:e.noop,exec:e.noop,destroy:function(){this._container&&this._container.remove();this._parent&&this._parent.removeClass("webuploader-container");this.off()}});d.orders="html5,flash";d.addRuntime=function(l,k){f[l]=k};d.hasRuntime=function(k){return !!(k?f[k]:j(f))};d.create=function(n,l){var k,m;l=l||d.orders;g.each(l.split(/\s*,\s*/g),function(){if(f[this]){k=this;return false}});k=k||j(f);if(!k){throw new Error("Runtime Error")}m=new f[k](n);return m};h.installTo(d.prototype);return d});c("runtime/client",["base","mediator","runtime/runtime"],function(g,h,f){var d;d=(function(){var j={};return{add:function(k){j[k.uid]=k},get:function(l,k){var m;if(l){return j[l]}for(m in j){if(k&&j[m].__standalone){continue}return j[m]}return null},remove:function(k){delete j[k.uid]}}})();function e(l,k){var j=g.Deferred(),m;this.uid=g.guid("client_");this.runtimeReady=function(n){return j.done(n)};this.connectRuntime=function(o,n){if(m){throw new Error("already connected!")}j.done(n);if(typeof o==="string"&&d.get(o)){m=d.get(o)}m=m||d.get(null,k);if(!m){m=f.create(o,o.runtimeOrder);m.__promise=j.promise();m.once("ready",j.resolve);m.init();d.add(m);m.__client=1}else{g.$.extend(m.options,o);m.__promise.then(j.resolve);m.__client++}k&&(m.__standalone=k);return m};this.getRuntime=function(){return m};this.disconnectRuntime=function(){if(!m){return}m.__client--;if(m.__client<=0){d.remove(m);delete m.__promise;m.destroy()}m=null};this.exec=function(){if(!m){return}var n=g.slice(arguments);l&&n.unshift(l);return m.exec.apply(this,n)};this.getRuid=function(){return m&&m.uid};this.destroy=(function(n){return function(){n&&n.apply(this,arguments);this.trigger("destroy");this.off();this.exec("destroy");this.disconnectRuntime()}})(this.destroy)}h.installTo(e.prototype);return e});c("lib/dnd",["base","mediator","runtime/client"],function(e,h,d){var f=e.$;function g(j){j=this.options=f.extend({},g.options,j);j.container=f(j.container);if(!j.container.length){return}d.call(this,"DragAndDrop")}g.options={accept:null,disableGlobalDnd:false};e.inherits(d,{constructor:g,init:function(){var j=this;j.connectRuntime(j.options,function(){j.exec("init");j.trigger("ready")})}});h.installTo(g.prototype);return g});c("widgets/widget",["base","uploader"],function(g,e){var f=g.$,j=e.prototype._init,l=e.prototype.destroy,h={},d=[];function m(p){if(!p){return false}var o=p.length,n=f.type(p);if(p.nodeType===1&&o){return true}return n==="array"||n!=="function"&&n!=="string"&&(o===0||typeof o==="number"&&o>0&&(o-1) in p)}function k(n){this.owner=n;this.options=n.options}f.extend(k.prototype,{init:g.noop,invoke:function(n,o){var p=this.responseMap;if(!p||!(n in p)||!(p[n] in this)||!f.isFunction(this[p[n]])){return h}return this[p[n]].apply(this,o)},request:function(){return this.owner.request.apply(this.owner,arguments)}});f.extend(e.prototype,{_init:function(){var p=this,o=p._widgets=[],n=p.options.disableWidgets||"";f.each(d,function(r,q){(!n||!~n.indexOf(q._name))&&o.push(new q(p))});return j.apply(p,arguments)},request:function(o,u,x){var r=0,v=this._widgets,t=v&&v.length,q=[],p=[],s,n,y,w;u=m(u)?u:[u];for(;r<t;r++){s=v[r];n=s.invoke(o,u);if(n!==h){if(g.isPromise(n)){p.push(n)}else{q.push(n)}}}if(x||p.length){y=g.when.apply(g,p);w=y.pipe?"pipe":"then";return y[w](function(){var z=g.Deferred(),A=arguments;
if(A.length===1){A=A[0]}setTimeout(function(){z.resolve(A)},1);return z.promise()})[x?w:"done"](x||g.noop)}else{return q[0]}},destroy:function(){l.apply(this,arguments);this._widgets=null}});e.register=k.register=function(o,q){var p={init:"init",destroy:"destroy",name:"anonymous"},n;if(arguments.length===1){q=o;f.each(q,function(r){if(r[0]==="_"||r==="name"){r==="name"&&(p.name=q.name);return}p[r.replace(/[A-Z]/g,"-$&").toLowerCase()]=r})}else{p=f.extend(p,o)}q.responseMap=p;n=g.inherits(k,q);n._name=p.name;d.push(n);return n};e.unRegister=k.unRegister=function(n){if(!n||n==="anonymous"){return}for(var o=d.length;o--;){if(d[o]._name===n){d.splice(o,1)}}};return k});c("widgets/filednd",["base","uploader","lib/dnd","widgets/widget"],function(e,g,d){var f=e.$;g.options.dnd="";return g.register({name:"dnd",init:function(m){if(!m.dnd||this.request("predict-runtime-type")!=="html5"){return}var l=this,h=e.Deferred(),j=f.extend({},{disableGlobalDnd:m.disableGlobalDnd,container:m.dnd,accept:m.accept}),k;this.dnd=k=new d(j);k.once("ready",h.resolve);k.on("drop",function(n){l.request("add-file",[n])});k.on("accept",function(n){return l.owner.trigger("dndAccept",n)});k.init();return h.promise()},destroy:function(){this.dnd&&this.dnd.destroy()}})});c("lib/filepaste",["base","mediator","runtime/client"],function(f,h,e){var g=f.$;function d(j){j=this.options=g.extend({},j);j.container=g(j.container||document.body);e.call(this,"FilePaste")}f.inherits(e,{constructor:d,init:function(){var j=this;j.connectRuntime(j.options,function(){j.exec("init");j.trigger("ready")})}});h.installTo(d.prototype);return d});c("widgets/filepaste",["base","uploader","lib/filepaste","widgets/widget"],function(e,g,d){var f=e.$;return g.register({name:"paste",init:function(l){if(!l.paste||this.request("predict-runtime-type")!=="html5"){return}var k=this,h=e.Deferred(),j=f.extend({},{container:l.paste,accept:l.accept}),m;this.paste=m=new d(j);m.once("ready",h.resolve);m.on("paste",function(n){k.owner.request("add-file",[n])});m.init();return h.promise()},destroy:function(){this.paste&&this.paste.destroy()}})});c("lib/blob",["base","runtime/client"],function(e,d){function f(g,j){var h=this;h.source=j;h.ruid=g;this.size=j.size||0;if(!j.type&&this.ext&&~"jpg,jpeg,png,gif,bmp".indexOf(this.ext)){this.type="image/"+(this.ext==="jpg"?"jpeg":this.ext)}else{this.type=j.type||"application/octet-stream"}d.call(h,"Blob");this.uid=j.uid||this.uid;if(g){h.connectRuntime(g)}}e.inherits(d,{constructor:f,slice:function(h,g){return this.exec("slice",h,g)},getSource:function(){return this.source}});return f});c("lib/file",["base","lib/blob"],function(g,h){var f=1,d=/\.([^.]+)$/;function e(j,k){var l;this.name=k.name||("untitled"+f++);l=d.exec(k.name)?RegExp.$1.toLowerCase():"";if(!l&&k.type){l=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(k.type)?RegExp.$1.toLowerCase():"";this.name+="."+l}this.ext=l;this.lastModifiedDate=k.lastModifiedDate||(new Date()).toLocaleString();h.apply(this,arguments)}return g.inherits(h,e)});c("lib/filepicker",["base","runtime/client","lib/file"],function(g,f,e){var h=g.$;function d(j){j=this.options=h.extend({},d.options,j);j.container=h(j.id);if(!j.container.length){throw new Error("按钮指定错误")}j.innerHTML=j.innerHTML||j.label||j.container.html()||"";j.button=h(j.button||document.createElement("div"));j.button.html(j.innerHTML);j.container.html(j.button);f.call(this,"FilePicker",true)}d.options={button:null,container:null,label:null,innerHTML:null,multiple:true,accept:null,name:"file"};g.inherits(f,{constructor:d,init:function(){var l=this,k=l.options,j=k.button;j.addClass("webuploader-pick");l.on("all",function(m){var n;switch(m){case"mouseenter":j.addClass("webuploader-pick-hover");break;case"mouseleave":j.removeClass("webuploader-pick-hover");break;case"change":n=l.exec("getFiles");l.trigger("select",h.map(n,function(o){o=new e(l.getRuid(),o);o._refer=k.container;return o}),k.container);break}});l.connectRuntime(k,function(){l.refresh();l.exec("init",k);l.trigger("ready")});this._resizeHandler=g.bindFn(this.refresh,this);h(b).on("resize",this._resizeHandler)},refresh:function(){var k=this.getRuntime().getContainer(),l=this.options.button,m=l.outerWidth?l.outerWidth():l.width(),j=l.outerHeight?l.outerHeight():l.height(),n=l.offset();m&&j&&k.css({bottom:"auto",right:"auto",width:m+"px",height:j+"px"}).offset(n)},enable:function(){var j=this.options.button;j.removeClass("webuploader-pick-disable");this.refresh()},disable:function(){var j=this.options.button;this.getRuntime().getContainer().css({top:"-99999px"});j.addClass("webuploader-pick-disable")},destroy:function(){var j=this.options.button;h(b).off("resize",this._resizeHandler);j.removeClass("webuploader-pick-disable webuploader-pick-hover "+"webuploader-pick")}});return d});c("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(e,g,d){var f=e.$;f.extend(g.options,{pick:null,accept:null});return g.register({name:"picker",init:function(h){this.pickers=[];return h.pick&&this.addBtn(h.pick)
},refresh:function(){f.each(this.pickers,function(){this.refresh()})},addBtn:function(k){var m=this,l=m.options,j=l.accept,h=[];if(!k){return}f.isPlainObject(k)||(k={id:k});f(k.id).each(function(){var p,o,n;n=e.Deferred();p=f.extend({},k,{accept:f.isPlainObject(j)?[j]:j,swf:l.swf,runtimeOrder:l.runtimeOrder,id:this});o=new d(p);o.once("ready",n.resolve);o.on("select",function(q){m.owner.request("add-file",[q])});o.init();m.pickers.push(o);h.push(n.promise())});return e.when.apply(e,h)},disable:function(){f.each(this.pickers,function(){this.disable()})},enable:function(){f.each(this.pickers,function(){this.enable()})},destroy:function(){f.each(this.pickers,function(){this.destroy()});this.pickers=null}})});c("lib/image",["base","runtime/client","lib/blob"],function(f,e,h){var g=f.$;function d(j){this.options=g.extend({},d.options,j);e.call(this,"Image");this.on("load",function(){this._info=this.exec("info");this._meta=this.exec("meta")})}d.options={quality:90,crop:false,preserveHeaders:false,allowMagnify:false};f.inherits(e,{constructor:d,info:function(j){if(j){this._info=j;return this}return this._info},meta:function(j){if(j){this._meta=j;return this}return this._meta},loadFromBlob:function(j){var l=this,k=j.getRuid();this.connectRuntime(k,function(){l.exec("init",l.options);l.exec("loadFromBlob",j)})},resize:function(){var j=f.slice(arguments);return this.exec.apply(this,["resize"].concat(j))},crop:function(){var j=f.slice(arguments);return this.exec.apply(this,["crop"].concat(j))},getAsDataUrl:function(j){return this.exec("getAsDataUrl",j)},getAsBlob:function(k){var j=this.exec("getAsBlob",k);return new h(this.getRuid(),j)}});return d});c("widgets/image",["base","uploader","lib/image","widgets/widget"],function(e,h,d){var g=e.$,f;f=(function(j){var k=0,m=[],l=function(){var n;while(m.length&&k<j){n=m.shift();k+=n[0];n[1]()}};return function(p,o,n){m.push([o,n]);p.once("destroy",function(){k-=o;setTimeout(l,1)});setTimeout(l,1)}})(5*1024*1024);g.extend(h.options,{thumb:{width:110,height:110,quality:70,allowMagnify:true,crop:true,preserveHeaders:false,type:"image/jpeg"},compress:{width:1600,height:1600,quality:90,allowMagnify:false,crop:false,preserveHeaders:true}});return h.register({name:"image",makeThumb:function(l,k,m,j){var n,o;l=this.request("get-file",l);if(!l.type.match(/^image/)){k(true);return}n=g.extend({},this.options.thumb);if(g.isPlainObject(m)){n=g.extend(n,m);m=null}m=m||n.width;j=j||n.height;o=new d(n);o.once("load",function(){l._info=l._info||o.info();l._meta=l._meta||o.meta();if(m<=1&&m>0){m=l._info.width*m}if(j<=1&&j>0){j=l._info.height*j}o.resize(m,j)});o.once("complete",function(){k(false,o.getAsDataUrl(n.type));o.destroy()});o.once("error",function(p){k(p||true);o.destroy()});f(o,l.source.size,function(){l._info&&o.info(l._info);l._meta&&o.meta(l._meta);o.loadFromBlob(l.source)})},beforeSendFile:function(l){var n=this.options.compress||this.options.resize,k=n&&n.compressSize||0,m=n&&n.noCompressIfLarger||false,o,j;l=this.request("get-file",l);if(!n||!~"image/jpeg,image/jpg".indexOf(l.type)||l.size<k||l._compressed){return}n=g.extend({},n);j=e.Deferred();o=new d(n);j.always(function(){o.destroy();o=null});o.once("error",j.reject);o.once("load",function(){var q=n.width,p=n.height;l._info=l._info||o.info();l._meta=l._meta||o.meta();if(q<=1&&q>0){q=l._info.width*q}if(p<=1&&p>0){p=l._info.height*p}o.resize(q,p)});o.once("complete",function(){var p,q;try{p=o.getAsBlob(n.type);q=l.size;if(!m||p.size<q){l.source=p;l.size=p.size;l.trigger("resize",p.size,q)}l._compressed=true;j.resolve()}catch(r){j.resolve()}});l._info&&o.info(l._info);l._meta&&o.meta(l._meta);o.loadFromBlob(l.source);return j.promise()}})});c("file",["base","mediator"],function(h,l){var f=h.$,d="WU_FILE_",g=0,j=/\.([^.]+)$/,e={};function k(){return d+g++}function m(n){this.name=n.name||"Untitled";this.size=n.size||0;this.type=n.type||"application/octet-stream";this.lastModifiedDate=n.lastModifiedDate||(new Date()*1);this.id=k();this.ext=j.exec(this.name)?RegExp.$1:"";this.statusText="";e[this.id]=m.Status.INITED;this.source=n;this.loaded=0;this.on("error",function(o){this.setStatus(m.Status.ERROR,o)})}f.extend(m.prototype,{setStatus:function(o,p){var n=e[this.id];typeof p!=="undefined"&&(this.statusText=p);if(o!==n){e[this.id]=o;this.trigger("statuschange",o,n)}},getStatus:function(){return e[this.id]},getSource:function(){return this.source},destroy:function(){this.off();delete e[this.id]}});l.installTo(m.prototype);m.Status={INITED:"inited",QUEUED:"queued",PROGRESS:"progress",ERROR:"error",COMPLETE:"complete",CANCELLED:"cancelled",INTERRUPT:"interrupt",INVALID:"invalid"};return m});c("queue",["base","mediator","file"],function(e,j,h){var g=e.$,d=h.Status;function f(){this.stats={numOfQueue:0,numOfSuccess:0,numOfCancel:0,numOfProgress:0,numOfUploadFailed:0,numOfInvalid:0,numofDeleted:0,numofInterrupt:0};this._queue=[];this._map={}}g.extend(f.prototype,{append:function(k){this._queue.push(k);this._fileAdded(k);return this},prepend:function(k){this._queue.unshift(k);
this._fileAdded(k);return this},getFile:function(k){if(typeof k!=="string"){return k}return this._map[k]},fetch:function(l){var k=this._queue.length,n,m;l=l||d.QUEUED;for(n=0;n<k;n++){m=this._queue[n];if(l===m.getStatus()){return m}}return null},sort:function(k){if(typeof k==="function"){this._queue.sort(k)}},getFiles:function(){var o=[].slice.call(arguments,0),l=[],n=0,k=this._queue.length,m;for(;n<k;n++){m=this._queue[n];if(o.length&&!~g.inArray(m.getStatus(),o)){continue}l.push(m)}return l},removeFile:function(m){var o=this,k=null,l=null,n=this._map[m.id];if(n){delete this._map[m.id];m.destroy();for(i=0;i<this._queue.length;i++){k=this._queue[i];if(m===k){l=this._queue.splice(i,1)[0];l.destroy();break}}this.stats.numofDeleted++}},_fileAdded:function(k){var m=this,l=this._map[k.id];if(!l){this._map[k.id]=k;k.on("statuschange",function(o,n){m._onFileStatusChange(o,n)})}},_onFileStatusChange:function(k,l){var m=this.stats;switch(l){case d.PROGRESS:m.numOfProgress--;break;case d.QUEUED:m.numOfQueue--;break;case d.ERROR:m.numOfUploadFailed--;break;case d.INVALID:m.numOfInvalid--;break;case d.INTERRUPT:m.numofInterrupt--;break}switch(k){case d.QUEUED:m.numOfQueue++;break;case d.PROGRESS:m.numOfProgress++;break;case d.ERROR:m.numOfUploadFailed++;break;case d.COMPLETE:m.numOfSuccess++;break;case d.CANCELLED:m.numOfCancel++;break;case d.INVALID:m.numOfInvalid++;break;case d.INTERRUPT:m.numofInterrupt++;break}}});j.installTo(f.prototype);return f});c("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(g,d,e,m,j,l){var f=g.$,h=/\.\w+$/,k=m.Status;return d.register({name:"queue",init:function(n){var t=this,v,s,q,u,r,o,p;if(f.isPlainObject(n.accept)){n.accept=[n.accept]}if(n.accept){r=[];for(q=0,s=n.accept.length;q<s;q++){u=n.accept[q].extensions;u&&r.push(u)}if(r.length){o="\\."+r.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"}t.accept=new RegExp(o,"i")}t.queue=new e();t.stats=t.queue.stats;if(this.request("predict-runtime-type")!=="html5"){return}v=g.Deferred();this.placeholder=p=new l("Placeholder");p.connectRuntime({runtimeOrder:"html5"},function(){t._ruid=p.getRuid();v.resolve()});return v.promise()},_wrapFile:function(n){if(!(n instanceof m)){if(!(n instanceof j)){if(!this._ruid){throw new Error("Can't add external files.")}n=new j(this._ruid,n)}n=new m(n)}return n},acceptFile:function(n){var o=!n||!n.size||this.accept&&h.exec(n.name)&&!this.accept.test(n.name);return !o},_addFile:function(n){var o=this;n=o._wrapFile(n);if(!o.owner.trigger("beforeFileQueued",n)){return}if(!o.acceptFile(n)){o.owner.trigger("error","Q_TYPE_DENIED",n);return}o.queue.append(n);o.owner.trigger("fileQueued",n);return n},getFile:function(n){return this.queue.getFile(n)},addFile:function(o){var n=this;if(!o.length){o=[o]}o=f.map(o,function(p){return n._addFile(p)});n.owner.trigger("filesQueued",o);if(n.options.auto){setTimeout(function(){n.request("start-upload")},20)}},getStats:function(){return this.stats},removeFile:function(o,n){var p=this;o=o.id?o:p.queue.getFile(o);this.request("cancel-file",o);if(n){this.queue.removeFile(o)}},getFiles:function(){return this.queue.getFiles.apply(this.queue,arguments)},fetchFile:function(){return this.queue.fetch.apply(this.queue,arguments)},retry:function(q,o){var s=this,r,p,n;if(q){q=q.id?q:s.queue.getFile(q);q.setStatus(k.QUEUED);o||s.request("start-upload");return}r=s.queue.getFiles(k.ERROR);p=0;n=r.length;for(;p<n;p++){q=r[p];q.setStatus(k.QUEUED)}s.request("start-upload")},sortFiles:function(){return this.queue.sort.apply(this.queue,arguments)},reset:function(){this.owner.trigger("reset");this.queue=new e();this.stats=this.queue.stats},destroy:function(){this.reset();this.placeholder&&this.placeholder.destroy()}})});c("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(e,d){e.support=function(){return d.hasRuntime.apply(d,arguments)};return e.register({name:"runtime",init:function(){if(!this.predictRuntimeType()){throw Error("Runtime Error")}},predictRuntimeType:function(){var j=this.options.runtimeOrder||d.orders,h=this.type,g,f;if(!h){j=j.split(/\s*,\s*/g);for(g=0,f=j.length;g<f;g++){if(d.hasRuntime(j[g])){this.type=h=j[g];break}}}return h}})});c("lib/transport",["base","runtime/client","mediator"],function(e,d,g){var f=e.$;function h(k){var j=this;k=j.options=f.extend(true,{},h.options,k||{});d.call(this,"Transport");this._blob=null;this._formData=k.formData||{};this._headers=k.headers||{};this.on("progress",this._timeout);this.on("load error",function(){j.trigger("progress",1);clearTimeout(j._timer)})}h.options={server:"",method:"POST",withCredentials:false,fileVal:"file",timeout:2*60*1000,formData:{},headers:{},sendAsBinary:false};f.extend(h.prototype,{appendBlob:function(l,k,j){var n=this,m=n.options;if(n.getRuid()){n.disconnectRuntime()}n.connectRuntime(k.ruid,function(){n.exec("init")});n._blob=k;m.fileVal=l||m.fileVal;m.filename=j||m.filename},append:function(j,k){if(typeof j==="object"){f.extend(this._formData,j)
}else{this._formData[j]=k}},setRequestHeader:function(j,k){if(typeof j==="object"){f.extend(this._headers,j)}else{this._headers[j]=k}},send:function(j){this.exec("send",j);this._timeout()},abort:function(){clearTimeout(this._timer);return this.exec("abort")},destroy:function(){this.trigger("destroy");this.off();this.exec("destroy");this.disconnectRuntime()},getResponse:function(){return this.exec("getResponse")},getResponseAsJson:function(){return this.exec("getResponseAsJson")},getStatus:function(){return this.exec("getStatus")},_timeout:function(){var j=this,k=j.options.timeout;if(!k){return}clearTimeout(j._timer);j._timer=setTimeout(function(){j.abort();j.trigger("error","timeout")},k)}});g.installTo(h.prototype);return h});c("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(f,k,j,l){var h=f.$,e=f.isPromise,d=j.Status;h.extend(k.options,{prepareNextFile:false,chunked:false,chunkSize:5*1024*1024,chunkRetry:2,threads:3,formData:{}});function g(p,q){var o=[],m=p.source,v=m.size,r=q?Math.ceil(v/q):1,n=0,u=0,t,s;s={file:p,has:function(){return !!o.length},shift:function(){return o.shift()},unshift:function(w){o.unshift(w)}};while(u<r){t=Math.min(q,v-n);o.push({file:p,start:n,end:q?(n+t):v,total:v,chunks:r,chunk:u++,cuted:s});n+=t}p.blocks=o.concat();p.remaning=o.length;return s}k.register({name:"upload",init:function(){var m=this.owner,n=this;this.runing=false;this.progress=false;m.on("startUpload",function(){n.progress=true}).on("uploadFinished",function(){n.progress=false});this.pool=[];this.stack=[];this.pending=[];this.remaning=0;this.__tick=f.bindFn(this._tick,this);m.on("uploadComplete",function(o){o.blocks&&h.each(o.blocks,function(q,p){p.transport&&(p.transport.abort(),p.transport.destroy());delete p.transport});delete o.blocks;delete o.remaning})},reset:function(){this.request("stop-upload",true);this.runing=false;this.pool=[];this.stack=[];this.pending=[];this.remaning=0;this._trigged=false;this._promise=null},startUpload:function(m){var o=this;h.each(o.request("get-files",d.INVALID),function(){o.request("remove-file",this)});if(m){m=m.id?m:o.request("get-file",m);if(m.getStatus()===d.INTERRUPT){h.each(o.pool,function(q,p){if(p.file!==m){return}p.transport&&p.transport.send()});m.setStatus(d.QUEUED)}else{if(m.getStatus()===d.PROGRESS){return}else{m.setStatus(d.QUEUED)}}}else{h.each(o.request("get-files",[d.INITED]),function(){this.setStatus(d.QUEUED)})}if(o.runing){return}o.runing=true;var n=[];h.each(o.pool,function(q,p){var r=p.file;if(r.getStatus()===d.INTERRUPT){n.push(r);o._trigged=false;p.transport&&p.transport.send()}});var m;while((m=n.shift())){m.setStatus(d.PROGRESS)}m||h.each(o.request("get-files",d.INTERRUPT),function(){this.setStatus(d.PROGRESS)});o._trigged=false;f.nextTick(o.__tick);o.owner.trigger("startUpload")},stopUpload:function(m,o){var n=this;if(m===true){o=m;m=null}if(n.runing===false){return}if(m){m=m.id?m:n.request("get-file",m);if(m.getStatus()!==d.PROGRESS&&m.getStatus()!==d.QUEUED){return}m.setStatus(d.INTERRUPT);h.each(n.pool,function(q,p){if(p.file!==m){return}p.transport&&p.transport.abort();n._putback(p);n._popBlock(p)});return f.nextTick(n.__tick)}n.runing=false;if(this._promise&&this._promise.file){this._promise.file.setStatus(d.INTERRUPT)}o&&h.each(n.pool,function(q,p){p.transport&&p.transport.abort();p.file.setStatus(d.INTERRUPT)});n.owner.trigger("stopUpload")},cancelFile:function(m){m=m.id?m:this.request("get-file",m);m.blocks&&h.each(m.blocks,function(p,o){var n=o.transport;if(n){n.abort();n.destroy();delete o.transport}});m.setStatus(d.CANCELLED);this.owner.trigger("fileDequeued",m)},isInProgress:function(){return !!this.progress},_getStats:function(){return this.request("get-stats")},skipFile:function(n,m){n=n.id?n:this.request("get-file",n);n.setStatus(m||d.COMPLETE);n.skipped=true;n.blocks&&h.each(n.blocks,function(q,p){var o=p.transport;if(o){o.abort();o.destroy();delete p.transport}});this.owner.trigger("uploadSkip",n)},_tick:function(){var o=this,n=o.options,m,p;if(o._promise){return o._promise.always(o.__tick)}if(o.pool.length<n.threads&&(p=o._nextBlock())){o._trigged=false;m=function(q){o._promise=null;q&&q.file&&o._startSend(q);f.nextTick(o.__tick)};o._promise=e(p)?p.always(m):m(p)}else{if(!o.remaning&&!o._getStats().numOfQueue&&!o._getStats().numofInterrupt){o.runing=false;o._trigged||f.nextTick(function(){o.owner.trigger("uploadFinished")});o._trigged=true}}},_putback:function(n){var m;n.cuted.unshift(n);m=this.stack.indexOf(n.cuted);if(!~m){this.stack.unshift(n.cuted)}},_getStack:function(){var n=0,m;while((m=this.stack[n++])){if(m.has()&&m.file.getStatus()===d.PROGRESS){return m}else{if(!m.has()||m.file.getStatus()!==d.PROGRESS&&m.file.getStatus()!==d.INTERRUPT){this.stack.splice(--n,1)}}}return null},_nextBlock:function(){var r=this,q=r.options,n,p,m,o;if((n=this._getStack())){if(q.prepareNextFile&&!r.pending.length){r._prepareNextFile()}return n.shift()}else{if(r.runing){if(!r.pending.length&&r._getStats().numOfQueue){r._prepareNextFile()
}p=r.pending.shift();m=function(s){if(!s){return null}n=g(s,q.chunked?q.chunkSize:0);r.stack.push(n);return n.shift()};if(e(p)){o=p.file;p=p[p.pipe?"pipe":"then"](m);p.file=o;return p}return m(p)}}},_prepareNextFile:function(){var n=this,m=n.request("fetch-file"),p=n.pending,o;if(m){o=n.request("before-send-file",m,function(){if(m.getStatus()===d.PROGRESS||m.getStatus()===d.INTERRUPT){return m}return n._finishFile(m)});n.owner.trigger("uploadStart",m);m.setStatus(d.PROGRESS);o.file=m;o.done(function(){var q=h.inArray(o,p);~q&&p.splice(q,1,m)});o.fail(function(q){m.setStatus(d.ERROR,q);n.owner.trigger("uploadError",m,q);n.owner.trigger("uploadComplete",m)});p.push(o)}},_popBlock:function(n){var m=h.inArray(n,this.pool);this.pool.splice(m,1);n.file.remaning--;this.remaning--},_startSend:function(p){var n=this,m=p.file,o;if(m.getStatus()!==d.PROGRESS){if(m.getStatus()===d.INTERRUPT){n._putback(p)}return}n.pool.push(p);n.remaning++;p.blob=p.chunks===1?m.source:m.source.slice(p.start,p.end);o=n.request("before-send",p,function(){if(m.getStatus()===d.PROGRESS){n._doSend(p)}else{n._popBlock(p);f.nextTick(n.__tick)}});o.fail(function(){if(m.remaning===1){n._finishFile(m).always(function(){p.percentage=1;n._popBlock(p);n.owner.trigger("uploadComplete",m);f.nextTick(n.__tick)})}else{p.percentage=1;n.updateFileProgress(m);n._popBlock(p);f.nextTick(n.__tick)}})},_doSend:function(q){var u=this,n=u.owner,m=u.options,p=q.file,t=new l(m),r=h.extend({},m.formData),o=h.extend({},m.headers),v,s;q.transport=t;t.on("destroy",function(){delete q.transport;u._popBlock(q);f.nextTick(u.__tick)});t.on("progress",function(w){q.percentage=w;u.updateFileProgress(p)});v=function(x){var w;s=t.getResponseAsJson()||{};s._raw=t.getResponse();w=function(y){x=y};if(!n.trigger("uploadAccept",q,s,w)){x=x||"server"}return x};t.on("error",function(x,w){q.retried=q.retried||0;if(q.chunks>1&&~"http,abort".indexOf(x)&&q.retried<m.chunkRetry){q.retried++;t.send()}else{if(!w&&x==="server"){x=v(x)}p.setStatus(d.ERROR,x);n.trigger("uploadError",p,x);n.trigger("uploadComplete",p)}});t.on("load",function(){var w;if((w=v())){t.trigger("error",w,true);return}if(p.remaning===1){u._finishFile(p,s)}else{t.destroy()}});r=h.extend(r,{id:p.id,name:p.name,type:p.type,lastModifiedDate:p.lastModifiedDate,size:p.size});q.chunks>1&&h.extend(r,{chunks:q.chunks,chunk:q.chunk});n.trigger("uploadBeforeSend",q,r,o);t.appendBlob(m.fileVal,q.blob,p.name);t.append(r);t.setRequestHeader(o);t.send()},_finishFile:function(o,n,p){var m=this.owner;return m.request("after-send-file",arguments,function(){o.setStatus(d.COMPLETE);m.trigger("uploadSuccess",o,n,p)}).fail(function(q){if(o.getStatus()===d.PROGRESS){o.setStatus(d.ERROR,q)}m.trigger("uploadError",o,q)}).always(function(){m.trigger("uploadComplete",o)})},updateFileProgress:function(o){var n=0,m=0;if(!o.blocks){return}h.each(o.blocks,function(q,p){m+=(p.percentage||0)*(p.end-p.start)});n=m/o.size;this.owner.trigger("uploadProgress",o,n||0)}})});c("widgets/validator",["base","uploader","file","widgets/widget"],function(e,j,h){var g=e.$,d={},f;f={addValidator:function(l,k){d[l]=k},removeValidator:function(k){delete d[k]}};j.register({name:"validator",init:function(){var k=this;e.nextTick(function(){g.each(d,function(){this.call(k.owner)})})}});f.addValidator("fileNumLimit",function(){var o=this,n=o.options,m=0,k=parseInt(n.fileNumLimit,10),l=true;if(!k){return}o.on("beforeFileQueued",function(p){if(m>=k&&l){l=false;this.trigger("error","Q_EXCEED_NUM_LIMIT",k,p);setTimeout(function(){l=true},1)}return m>=k?false:true});o.on("fileQueued",function(){m++});o.on("fileDequeued",function(){m--});o.on("reset",function(){m=0})});f.addValidator("fileSizeLimit",function(){var o=this,n=o.options,m=0,k=parseInt(n.fileSizeLimit,10),l=true;if(!k){return}o.on("beforeFileQueued",function(p){var q=m+p.size>k;if(q&&l){l=false;this.trigger("error","Q_EXCEED_SIZE_LIMIT",k,p);setTimeout(function(){l=true},1)}return q?false:true});o.on("fileQueued",function(p){m+=p.size});o.on("fileDequeued",function(p){m-=p.size});o.on("reset",function(){m=0})});f.addValidator("fileSingleSizeLimit",function(){var m=this,l=m.options,k=l.fileSingleSizeLimit;if(!k){return}m.on("beforeFileQueued",function(n){if(n.size>k){n.setStatus(h.Status.INVALID,"exceed_size");this.trigger("error","F_EXCEED_SIZE",k,n);return false}})});f.addValidator("duplicate",function(){var n=this,l=n.options,k={};if(l.duplicate){return}function m(s){var r=0,q=0,o=s.length,p;for(;q<o;q++){p=s.charCodeAt(q);r=p+(r<<6)+(r<<16)-r}return r}n.on("beforeFileQueued",function(o){var p=o.__hash||(o.__hash=m(o.name+o.size+o.lastModifiedDate));if(k[p]){this.trigger("error","F_DUPLICATE",o);return false}});n.on("fileQueued",function(o){var p=o.__hash;p&&(k[p]=true)});n.on("fileDequeued",function(o){var p=o.__hash;p&&(delete k[p])});n.on("reset",function(){k={}})});return f});c("lib/md5",["runtime/client","mediator"],function(e,f){function d(){e.call(this,"Md5")}f.installTo(d.prototype);d.prototype.loadFromBlob=function(g){var h=this;
if(h.getRuid()){h.disconnectRuntime()}h.connectRuntime(g.ruid,function(){h.exec("init");h.exec("loadFromBlob",g)})};d.prototype.getResult=function(){return this.exec("getResult")};return d});c("widgets/md5",["base","uploader","lib/md5","lib/blob","widgets/widget"],function(e,f,d,g){return f.register({name:"md5",md5File:function(l,n,h){var m=new d(),k=e.Deferred(),j=(l instanceof g)?l:this.request("get-file",l).source;m.on("progress load",function(o){o=o||{};k.notify(o.total?o.loaded/o.total:1)});m.on("complete",function(){k.resolve(m.getResult())});m.on("error",function(o){k.reject(o)});if(arguments.length>1){n=n||0;h=h||0;n<0&&(n=j.size+n);h<0&&(h=j.size+h);h=Math.min(h,j.size);j=j.slice(n,h)}m.loadFromBlob(j);return k.promise()}})});c("runtime/compbase",[],function(){function d(e,f){this.owner=e;this.options=e.options;this.getRuntime=function(){return f};this.getRuid=function(){return f.uid};this.trigger=function(){return e.trigger.apply(e,arguments)}}return d});c("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(e,d,j){var f="html5",g={};function h(){var l={},m=this,k=this.destroy;d.apply(m,arguments);m.type=f;m.exec=function(p,s){var o=this,r=o.uid,q=e.slice(arguments,2),n;if(g[p]){n=l[r]=l[r]||new g[p](o,m);if(n[s]){return n[s].apply(n,q)}}};m.destroy=function(){return k&&k.apply(this,arguments)}}e.inherits(d,{constructor:h,init:function(){var k=this;setTimeout(function(){k.trigger("ready")},1)}});h.register=function(m,l){var k=g[m]=e.inherits(j,l);return k};if(b.Blob&&b.FileReader&&b.DataView){d.addRuntime(f,h)}return h});c("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(e,d){return e.register("Blob",{slice:function(j,f){var g=this.owner.source,h=g.slice||g.webkitSlice||g.mozSlice;g=h.call(g,j,f);return new d(this.getRuid(),g)}})});c("runtime/html5/dnd",["base","runtime/html5/runtime","lib/file"],function(e,h,d){var g=e.$,f="webuploader-dnd-";return h.register("DragAndDrop",{init:function(){var j=this.elem=this.options.container;this.dragEnterHandler=e.bindFn(this._dragEnterHandler,this);this.dragOverHandler=e.bindFn(this._dragOverHandler,this);this.dragLeaveHandler=e.bindFn(this._dragLeaveHandler,this);this.dropHandler=e.bindFn(this._dropHandler,this);this.dndOver=false;j.on("dragenter",this.dragEnterHandler);j.on("dragover",this.dragOverHandler);j.on("dragleave",this.dragLeaveHandler);j.on("drop",this.dropHandler);if(this.options.disableGlobalDnd){g(document).on("dragover",this.dragOverHandler);g(document).on("drop",this.dropHandler)}},_dragEnterHandler:function(m){var l=this,k=l._denied||false,j;m=m.originalEvent||m;if(!l.dndOver){l.dndOver=true;j=m.dataTransfer.items;if(j&&j.length){l._denied=k=!l.trigger("accept",j)}l.elem.addClass(f+"over");l.elem[k?"addClass":"removeClass"](f+"denied")}m.dataTransfer.dropEffect=k?"none":"copy";return false},_dragOverHandler:function(k){var j=this.elem.parent().get(0);if(j&&!g.contains(j,k.currentTarget)){return false}clearTimeout(this._leaveTimer);this._dragEnterHandler.call(this,k);return false},_dragLeaveHandler:function(){var k=this,j;j=function(){k.dndOver=false;k.elem.removeClass(f+"over "+f+"denied")};clearTimeout(k._leaveTimer);k._leaveTimer=setTimeout(j,100);return false},_dropHandler:function(p){var m=this,k=m.getRuid(),j=m.elem.parent().get(0),o,n;if(j&&!g.contains(j,p.currentTarget)){return false}p=p.originalEvent||p;o=p.dataTransfer;try{n=o.getData("text/html")}catch(l){}if(n){return}m._getTansferFiles(o,function(q){m.trigger("drop",g.map(q,function(r){return new d(k,r)}))});m.dndOver=false;m.elem.removeClass(f+"over");return false},_getTansferFiles:function(q,r){var m=[],p=[],o,j,k,s,l,n,t;o=q.items;j=q.files;t=!!(o&&o[0].webkitGetAsEntry);for(l=0,n=j.length;l<n;l++){k=j[l];s=o&&o[l];if(t&&s.webkitGetAsEntry().isDirectory){p.push(this._traverseDirectoryTree(s.webkitGetAsEntry(),m))}else{m.push(k)}}e.when.apply(e,p).done(function(){if(!m.length){return}r(m)})},_traverseDirectoryTree:function(m,k){var j=e.Deferred(),l=this;if(m.isFile){m.file(function(n){k.push(n);j.resolve()})}else{if(m.isDirectory){m.createReader().readEntries(function(p){var o=p.length,r=[],n=[],q;for(q=0;q<o;q++){r.push(l._traverseDirectoryTree(p[q],n))}e.when.apply(e,r).then(function(){k.push.apply(k,n);j.resolve()},j.reject)})}}return j.promise()},destroy:function(){var j=this.elem;if(!j){return}j.off("dragenter",this.dragEnterHandler);j.off("dragover",this.dragOverHandler);j.off("dragleave",this.dragLeaveHandler);j.off("drop",this.dropHandler);if(this.options.disableGlobalDnd){g(document).off("dragover",this.dragOverHandler);g(document).off("drop",this.dropHandler)}}})});c("runtime/html5/filepaste",["base","runtime/html5/runtime","lib/file"],function(e,f,d){return f.register("FilePaste",{init:function(){var n=this.options,m=this.elem=n.container,k=".*",h,j,g,l;if(n.accept){h=[];for(j=0,g=n.accept.length;j<g;j++){l=n.accept[j].mimeTypes;l&&h.push(l)}if(h.length){k=h.join(",");k=k.replace(/,/g,"|").replace(/\*/g,".*")}}this.accept=k=new RegExp(k,"i");
this.hander=e.bindFn(this._pasteHander,this);m.on("paste",this.hander)},_pasteHander:function(n){var o=[],k=this.getRuid(),j,m,h,l,g;n=n.originalEvent||n;j=n.clipboardData.items;for(l=0,g=j.length;l<g;l++){m=j[l];if(m.kind!=="file"||!(h=m.getAsFile())){continue}o.push(new d(k,h))}if(o.length){n.preventDefault();n.stopPropagation();this.trigger("paste",o)}},destroy:function(){this.elem.off("paste",this.hander)}})});c("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(d,f){var e=d.$;return f.register("FilePicker",{init:function(){var h=this.getRuntime().getContainer(),n=this,j=n.owner,g=n.options,p=this.label=e(document.createElement("label")),q=this.input=e(document.createElement("input")),l,k,m,o;q.attr("type","file");q.attr("name",g.name);q.addClass("webuploader-element-invisible");p.on("click",function(){q.trigger("click")});p.css({opacity:0,width:"100%",height:"100%",display:"block",cursor:"pointer",background:"#ffffff"});if(g.multiple){q.attr("multiple","multiple")}if(g.accept&&g.accept.length>0){l=[];for(k=0,m=g.accept.length;k<m;k++){l.push(g.accept[k].mimeTypes)}q.attr("accept",l.join(","))}h.append(q);h.append(p);o=function(r){j.trigger(r.type)};q.on("change",function(s){var r=arguments.callee,t;n.files=s.target.files;t=this.cloneNode(true);t.value=null;this.parentNode.replaceChild(t,this);q.off();q=e(t).on("change",r).on("mouseenter mouseleave",o);j.trigger("change")});p.on("mouseenter mouseleave",o)},getFiles:function(){return this.files},destroy:function(){this.input.off();this.label.off()}})});c("runtime/html5/util",["base"],function(e){var f=b.createObjectURL&&b||b.URL&&URL.revokeObjectURL&&URL||b.webkitURL,g=e.noop,d=g;if(f){g=function(){return f.createObjectURL.apply(f,arguments)};d=function(){return f.revokeObjectURL.apply(f,arguments)}}return{createObjectURL:g,revokeObjectURL:d,dataURL2Blob:function(j){var m,o,l,k,h,n;n=j.split(",");if(~n[0].indexOf("base64")){m=atob(n[1])}else{m=decodeURIComponent(n[1])}l=new ArrayBuffer(m.length);o=new Uint8Array(l);for(k=0;k<m.length;k++){o[k]=m.charCodeAt(k)}h=n[0].split(":")[1].split(";")[0];return this.arrayBufferToBlob(l,h)},dataURL2ArrayBuffer:function(h){var k,m,j,l;l=h.split(",");if(~l[0].indexOf("base64")){k=atob(l[1])}else{k=decodeURIComponent(l[1])}m=new Uint8Array(k.length);for(j=0;j<k.length;j++){m[j]=k.charCodeAt(j)}return m.buffer},arrayBufferToBlob:function(h,k){var j=b.BlobBuilder||b.WebKitBlobBuilder,l;if(j){l=new j();l.append(h);return l.getBlob(k)}return new Blob([h],k?{type:k}:{})},canvasToDataUrl:function(h,j,k){return h.toDataURL(j,k/100)},parseMeta:function(h,j){j(false,{})},updateImageHead:function(h){return h}}});c("runtime/html5/imagemeta",["runtime/html5/util"],function(e){var d;d={parsers:{65505:[]},maxMetaDataSize:262144,parse:function(h,f){var j=this,g=new FileReader();g.onload=function(){f(false,j._parse(this.result));g=g.onload=g.onerror=null};g.onerror=function(k){f(k.message);g=g.onload=g.onerror=null};h=h.slice(0,j.maxMetaDataSize);g.readAsArrayBuffer(h.getSource())},_parse:function(k,p){if(k.byteLength<6){return}var m=new DataView(k),j=2,g=m.byteLength-4,n=j,o={},f,h,q,l;if(m.getUint16(0)===65496){while(j<g){f=m.getUint16(j);if(f>=65504&&f<=65519||f===65534){h=m.getUint16(j+2)+2;if(j+h>m.byteLength){break}q=d.parsers[f];if(!p&&q){for(l=0;l<q.length;l+=1){q[l].call(d,m,j,h,o)}}j+=h;n=j}else{break}}if(n>6){if(k.slice){o.imageHead=k.slice(2,n)}else{o.imageHead=new Uint8Array(k).subarray(2,n)}}}return o},updateImageHead:function(f,g){var j=this._parse(f,true),k,h,l;l=2;if(j.imageHead){l=2+j.imageHead.byteLength}if(f.slice){h=f.slice(l)}else{h=new Uint8Array(f).subarray(l)}k=new Uint8Array(g.byteLength+2+h.byteLength);k[0]=255;k[1]=216;k.set(new Uint8Array(g),2);k.set(new Uint8Array(h),g.byteLength+2);return k.buffer}};e.parseMeta=function(){return d.parse.apply(d,arguments)};e.updateImageHead=function(){return d.updateImageHead.apply(d,arguments)};return d});c("runtime/html5/imagemeta/exif",["base","runtime/html5/imagemeta"],function(f,e){var d={};d.ExifMap=function(){return this};d.ExifMap.prototype.map={"Orientation":274};d.ExifMap.prototype.get=function(g){return this[g]||this[this.map[g]]};d.exifTagTypes={1:{getValue:function(h,g){return h.getUint8(g)},size:1},2:{getValue:function(h,g){return String.fromCharCode(h.getUint8(g))},size:1,ascii:true},3:{getValue:function(j,g,h){return j.getUint16(g,h)},size:2},4:{getValue:function(j,g,h){return j.getUint32(g,h)},size:4},5:{getValue:function(j,g,h){return j.getUint32(g,h)/j.getUint32(g+4,h)},size:8},9:{getValue:function(j,g,h){return j.getInt32(g,h)},size:4},10:{getValue:function(j,g,h){return j.getInt32(g,h)/j.getInt32(g+4,h)},size:8}};d.exifTagTypes[7]=d.exifTagTypes[1];d.getExifValue=function(r,q,l,p,j,g){var s=d.exifTagTypes[p],h,k,t,m,o,n;if(!s){f.log("Invalid Exif data: Invalid tag type.");return}h=s.size*j;k=h>4?q+r.getUint32(l+8,g):(l+8);if(k+h>r.byteLength){f.log("Invalid Exif data: Invalid data offset.");return}if(j===1){return s.getValue(r,k,g)}t=[];
for(m=0;m<j;m+=1){t[m]=s.getValue(r,k+m*s.size,g)}if(s.ascii){o="";for(m=0;m<t.length;m+=1){n=t[m];if(n==="\u0000"){break}o+=n}return o}return t};d.parseExifTag=function(m,h,l,k,j){var g=m.getUint16(l,k);j.exif[g]=d.getExifValue(m,h,l,m.getUint16(l+2,k),m.getUint32(l+4,k),k)};d.parseExifTags=function(n,k,h,m,l){var o,g,j;if(h+6>n.byteLength){f.log("Invalid Exif data: Invalid directory offset.");return}o=n.getUint16(h,m);g=h+2+12*o;if(g+4>n.byteLength){f.log("Invalid Exif data: Invalid directory size.");return}for(j=0;j<o;j+=1){this.parseExifTag(n,k,h+2+12*j,m,l)}return n.getUint32(g,m)};d.parseExifData=function(n,m,j,k){var h=m+10,l,g;if(n.getUint32(m+4)!==1165519206){return}if(h+8>n.byteLength){f.log("Invalid Exif data: Invalid segment size.");return}if(n.getUint16(m+8)!==0){f.log("Invalid Exif data: Missing byte alignment offset.");return}switch(n.getUint16(h)){case 18761:l=true;break;case 19789:l=false;break;default:f.log("Invalid Exif data: Invalid byte alignment marker.");return}if(n.getUint16(h+2,l)!==42){f.log("Invalid Exif data: Missing TIFF marker.");return}g=n.getUint32(h+4,l);k.exif=new d.ExifMap();g=d.parseExifTags(n,h,h+g,l,k)};e.parsers[65505].push(d.parseExifData);return d});c("runtime/html5/jpegencoder",[],function(e,d,f){function g(s){var u=this;var K=Math.round;var S=Math.floor;var o=new Array(64);var R=new Array(64);var Y=new Array(64);var af=new Array(64);var I;var p;var y;var ab;var Q=new Array(65535);var t=new Array(65535);var W=new Array(64);var Z=new Array(64);var q=[];var J=0;var h=7;var L=new Array(64);var l=new Array(64);var ac=new Array(64);var m=new Array(256);var M=new Array(2048);var H;var V=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63];var n=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];var j=[0,1,2,3,4,5,6,7,8,9,10,11];var G=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125];var A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250];var F=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];var ag=[0,1,2,3,4,5,6,7,8,9,10,11];var v=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119];var C=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function T(ao){var an=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(var am=0;am<64;am++){var ar=S((an[am]*ao+50)/100);if(ar<1){ar=1}else{if(ar>255){ar=255}}o[V[am]]=ar}var ap=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(var al=0;al<64;al++){var aq=S((ap[al]*ao+50)/100);if(aq<1){aq=1}else{if(aq>255){aq=255}}R[V[al]]=aq}var ak=[1,1.387039845,1.306562965,1.175875602,1,0.785694958,0.5411961,0.275899379];var aj=0;for(var at=0;at<8;at++){for(var ai=0;ai<8;ai++){Y[aj]=(1/(o[V[aj]]*ak[at]*ak[ai]*8));af[aj]=(1/(R[V[aj]]*ak[at]*ak[ai]*8));aj++}}}function P(am,an){var al=0;var ao=0;var ak=new Array();for(var ai=1;ai<=16;ai++){for(var aj=1;aj<=am[ai];aj++){ak[an[ao]]=[];ak[an[ao]][0]=al;ak[an[ao]][1]=ai;ao++;al++}al*=2}return ak}function ae(){I=P(n,j);p=P(F,ag);y=P(G,A);ab=P(v,C)}function D(){var aj=1;var al=2;for(var ai=1;ai<=15;ai++){for(var ak=aj;ak<al;ak++){t[32767+ak]=ai;Q[32767+ak]=[];Q[32767+ak][1]=ai;Q[32767+ak][0]=ak}for(var am=-(al-1);am<=-aj;am++){t[32767+am]=ai;Q[32767+am]=[];Q[32767+am][1]=ai;Q[32767+am][0]=al-1+am}aj<<=1;al<<=1}}function ad(){for(var ai=0;ai<256;ai++){M[ai]=19595*ai;M[(ai+256)>>0]=38470*ai;M[(ai+512)>>0]=7471*ai+32768;M[(ai+768)>>0]=-11059*ai;M[(ai+1024)>>0]=-21709*ai;M[(ai+1280)>>0]=32768*ai+8421375;M[(ai+1536)>>0]=-27439*ai;M[(ai+1792)>>0]=-5329*ai}}function ah(aj){var ak=aj[0];var ai=aj[1]-1;while(ai>=0){if(ak&(1<<ai)){J|=(1<<h)}ai--;h--;if(h<0){if(J==255){z(255);z(0)}else{z(J)}h=7;J=0}}}function z(ai){q.push(m[ai])
}function O(ai){z((ai>>8)&255);z((ai)&255)}function U(a6,aD){var aU,aT,aS,aR,aQ,aO,aN,aL;var aX=0;var aZ;var aC=8;var aw=64;for(aZ=0;aZ<aC;++aZ){aU=a6[aX];aT=a6[aX+1];aS=a6[aX+2];aR=a6[aX+3];aQ=a6[aX+4];aO=a6[aX+5];aN=a6[aX+6];aL=a6[aX+7];var a7=aU+aL;var aW=aU-aL;var a5=aT+aN;var aY=aT-aN;var a4=aS+aO;var a0=aS-aO;var a3=aR+aQ;var a1=aR-aQ;var aA=a7+a3;var ax=a7-a3;var az=a5+a4;var ay=a5-a4;a6[aX]=aA+az;a6[aX+4]=aA-az;var aI=(ay+ax)*0.707106781;a6[aX+2]=ax+aI;a6[aX+6]=ax-aI;aA=a1+a0;az=a0+aY;ay=aY+aW;var aE=(aA-ay)*0.382683433;var aH=0.5411961*aA+aE;var aF=1.306562965*ay+aE;var aG=az*0.707106781;var at=aW+aG;var ar=aW-aG;a6[aX+5]=ar+aH;a6[aX+3]=ar-aH;a6[aX+1]=at+aF;a6[aX+7]=at-aF;aX+=8}aX=0;for(aZ=0;aZ<aC;++aZ){aU=a6[aX];aT=a6[aX+8];aS=a6[aX+16];aR=a6[aX+24];aQ=a6[aX+32];aO=a6[aX+40];aN=a6[aX+48];aL=a6[aX+56];var av=aU+aL;var aB=aU-aL;var ap=aT+aN;var aJ=aT-aN;var am=aS+aO;var aM=aS-aO;var aj=aR+aQ;var a2=aR-aQ;var au=av+aj;var ai=av-aj;var ao=ap+am;var al=ap-am;a6[aX]=au+ao;a6[aX+32]=au-ao;var aq=(al+ai)*0.707106781;a6[aX+16]=ai+aq;a6[aX+48]=ai-aq;au=a2+aM;ao=aM+aJ;al=aJ+aB;var aV=(au-al)*0.382683433;var an=0.5411961*au+aV;var a9=1.306562965*al+aV;var ak=ao*0.707106781;var a8=aB+ak;var aK=aB-ak;a6[aX+40]=aK+an;a6[aX+24]=aK-an;a6[aX+8]=a8+a9;a6[aX+56]=a8-a9;aX++}var aP;for(aZ=0;aZ<aw;++aZ){aP=a6[aZ]*aD[aZ];W[aZ]=(aP>0)?((aP+0.5)|0):((aP-0.5)|0)}return W}function aa(){O(65504);O(16);z(74);z(70);z(73);z(70);z(0);z(1);z(1);z(0);O(1);O(1);z(0);z(0)}function N(aj,ai){O(65472);O(17);z(8);O(ai);O(aj);z(3);z(1);z(17);z(0);z(2);z(17);z(1);z(3);z(17);z(1)}function B(){O(65499);O(132);z(0);for(var aj=0;aj<64;aj++){z(o[aj])}z(1);for(var ai=0;ai<64;ai++){z(R[ai])}}function x(){O(65476);O(418);z(0);for(var am=0;am<16;am++){z(n[am+1])}for(var al=0;al<=11;al++){z(j[al])}z(16);for(var ak=0;ak<16;ak++){z(G[ak+1])}for(var aj=0;aj<=161;aj++){z(A[aj])}z(1);for(var ai=0;ai<16;ai++){z(F[ai+1])}for(var ap=0;ap<=11;ap++){z(ag[ap])}z(17);for(var ao=0;ao<16;ao++){z(v[ao+1])}for(var an=0;an<=161;an++){z(C[an])}}function w(){O(65498);O(12);z(3);z(1);z(0);z(2);z(17);z(3);z(17);z(0);z(63);z(0)}function r(am,ai,at,ay,ax){var ao=ax[0];var ak=ax[240];var al;var az=16;var ap=63;var an=64;var aA=U(am,ai);for(var au=0;au<an;++au){Z[V[au]]=aA[au]}var aw=Z[0]-at;at=Z[0];if(aw==0){ah(ay[0])}else{al=32767+aw;ah(ay[t[al]]);ah(Q[al])}var aj=63;for(;(aj>0)&&(Z[aj]==0);aj--){}if(aj==0){ah(ao);return at}var av=1;var aC;while(av<=aj){var ar=av;for(;(Z[av]==0)&&(av<=aj);++av){}var aq=av-ar;if(aq>=az){aC=aq>>4;for(var aB=1;aB<=aC;++aB){ah(ak)}aq=aq&15}al=32767+Z[av];ah(ax[(aq<<4)+t[al]]);ah(Q[al]);av++}if(aj!=ap){ah(ao)}return at}function E(){var aj=String.fromCharCode;for(var ai=0;ai<256;ai++){m[ai]=aj(ai)}}this.encode=function(aw,aq){if(aq){k(aq)}q=new Array();J=0;h=7;O(65496);aa();B();N(aw.width,aw.height);x();w();var ar=0;var ax=0;var av=0;J=0;h=7;this.encode.displayName="_encode_";var aD=aw.data;var aA=aw.width;var au=aw.height;var az=aA*4;var ai=aA*3;var ap,ao=0;var at,aC,aE;var aj,ay,al,an,am;while(ao<au){ap=0;while(ap<az){aj=az*ao+ap;ay=aj;al=-1;an=0;for(am=0;am<64;am++){an=am>>3;al=(am&7)*4;ay=aj+(an*az)+al;if(ao+an>=au){ay-=(az*(ao+1+an-au))}if(ap+al>=az){ay-=((ap+al)-az+4)}at=aD[ay++];aC=aD[ay++];aE=aD[ay++];L[am]=((M[at]+M[(aC+256)>>0]+M[(aE+512)>>0])>>16)-128;l[am]=((M[(at+768)>>0]+M[(aC+1024)>>0]+M[(aE+1280)>>0])>>16)-128;ac[am]=((M[(at+1280)>>0]+M[(aC+1536)>>0]+M[(aE+1792)>>0])>>16)-128}ar=r(L,Y,ar,I,y);ax=r(l,af,ax,p,ab);av=r(ac,af,av,p,ab);ap+=32}ao+=8}if(h>=0){var aB=[];aB[1]=h+1;aB[0]=(1<<(h+1))-1;ah(aB)}O(65497);var ak="data:image/jpeg;base64,"+btoa(q.join(""));q=[];return ak};function k(aj){if(aj<=0){aj=1}if(aj>100){aj=100}if(H==aj){return}var ai=0;if(aj<50){ai=Math.floor(5000/aj)}else{ai=Math.floor(200-aj*2)}T(ai);H=aj}function X(){if(!s){s=50}E();ae();D();ad();k(s)}X()}g.encode=function(j,k){var h=new g(k);return h.encode(j)};return g});c("runtime/html5/androidpatch",["runtime/html5/util","runtime/html5/jpegencoder","base"],function(h,g,f){var d=h.canvasToDataUrl,e;h.canvasToDataUrl=function(l,n,q){var k,j,m,o,p;if(!f.os.android){return d.apply(null,arguments)}if(n==="image/jpeg"&&typeof e==="undefined"){o=d.apply(null,arguments);p=o.split(",");if(~p[0].indexOf("base64")){o=atob(p[1])}else{o=decodeURIComponent(p[1])}o=o.substring(0,2);e=o.charCodeAt(0)===255&&o.charCodeAt(1)===216}if(n==="image/jpeg"&&!e){j=l.width;m=l.height;k=l.getContext("2d");return g.encode(k.getImageData(0,0,j,m),q)}return d.apply(null,arguments)}});c("runtime/html5/image",["base","runtime/html5/runtime","runtime/html5/util"],function(d,g,e){var f="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D";return g.register("Image",{modified:false,init:function(){var j=this,h=new Image();h.onload=function(){j._info={type:j.type,width:this.width,height:this.height};if(!j._metas&&"image/jpeg"===j.type){e.parseMeta(j._blob,function(l,k){j._metas=k;j.owner.trigger("load")})}else{j.owner.trigger("load")}};h.onerror=function(){j.owner.trigger("error")};j._img=h},loadFromBlob:function(j){var k=this,h=k._img;
k._blob=j;k.type=j.type;h.src=e.createObjectURL(j.getSource());k.owner.once("load",function(){e.revokeObjectURL(h.src)})},resize:function(k,h){var j=this._canvas||(this._canvas=document.createElement("canvas"));this._resize(this._img,j,k,h);this._blob=null;this.modified=true;this.owner.trigger("complete","resize")},crop:function(q,p,r,o,u){var n=this._canvas||(this._canvas=document.createElement("canvas")),j=this.options,m=this._img,l=m.naturalWidth,t=m.naturalHeight,k=this.getOrientation();u=u||1;n.width=r;n.height=o;j.preserveHeaders||this._rotate2Orientaion(n,k);this._renderImageToCanvas(n,m,-q,-p,l*u,t*u);this._blob=null;this.modified=true;this.owner.trigger("complete","crop")},getAsBlob:function(k){var h=this._blob,l=this.options,j;k=k||this.type;if(this.modified||this.type!==k){j=this._canvas;if(k==="image/jpeg"){h=e.canvasToDataUrl(j,k,l.quality);if(l.preserveHeaders&&this._metas&&this._metas.imageHead){h=e.dataURL2ArrayBuffer(h);h=e.updateImageHead(h,this._metas.imageHead);h=e.arrayBufferToBlob(h,k);return h}}else{h=e.canvasToDataUrl(j,k)}h=e.dataURL2Blob(h)}return h},getAsDataUrl:function(h){var j=this.options;h=h||this.type;if(h==="image/jpeg"){return e.canvasToDataUrl(this._canvas,h,j.quality)}else{return this._canvas.toDataURL(h)}},getOrientation:function(){return this._metas&&this._metas.exif&&this._metas.exif.get("Orientation")||1},info:function(h){if(h){this._info=h;return this}return this._info},meta:function(h){if(h){this._meta=h;return this}return this._meta},destroy:function(){var h=this._canvas;this._img.onload=null;if(h){h.getContext("2d").clearRect(0,0,h.width,h.height);h.width=h.height=0;this._canvas=null}this._img.src=f;this._img=this._blob=null},_resize:function(n,p,k,v){var j=this.options,q=n.width,u=n.height,l=this.getOrientation(),m,t,o,s,r;if(~[5,6,7,8].indexOf(l)){k^=v;v^=k;k^=v}m=Math[j.crop?"max":"min"](k/q,v/u);j.allowMagnify||(m=Math.min(1,m));t=q*m;o=u*m;if(j.crop){p.width=k;p.height=v}else{p.width=t;p.height=o}s=(p.width-t)/2;r=(p.height-o)/2;j.preserveHeaders||this._rotate2Orientaion(p,l);this._renderImageToCanvas(p,n,s,r,t,o)},_rotate2Orientaion:function(l,k){var m=l.width,h=l.height,j=l.getContext("2d");switch(k){case 5:case 6:case 7:case 8:l.width=h;l.height=m;break}switch(k){case 2:j.translate(m,0);j.scale(-1,1);break;case 3:j.translate(m,h);j.rotate(Math.PI);break;case 4:j.translate(0,h);j.scale(1,-1);break;case 5:j.rotate(0.5*Math.PI);j.scale(1,-1);break;case 6:j.rotate(0.5*Math.PI);j.translate(0,-h);break;case 7:j.rotate(0.5*Math.PI);j.translate(m,-h);j.scale(-1,1);break;case 8:j.rotate(-0.5*Math.PI);j.translate(-m,0);break}},_renderImageToCanvas:(function(){if(!d.os.ios){return function(m){var l=d.slice(arguments,1),k=m.getContext("2d");k.drawImage.apply(k,l)}}function j(o,l,t){var k=document.createElement("canvas"),u=k.getContext("2d"),r=0,p=t,s=t,n,m,q;k.width=1;k.height=t;u.drawImage(o,0,0);n=u.getImageData(0,0,1,t).data;while(s>r){m=n[(s-1)*4+3];if(m===0){p=s}else{r=s}s=(p+r)>>1}q=(s/t);return(q===0)?1:q}if(d.os.ios>=7){return function(k,m,q,p,r,n){var l=m.naturalWidth,s=m.naturalHeight,o=j(m,l,s);return k.getContext("2d").drawImage(m,0,0,l*o,s*o,q,p,r,n)}}function h(m){var l=m.naturalWidth,o=m.naturalHeight,n,k;if(l*o>1024*1024){n=document.createElement("canvas");n.width=n.height=1;k=n.getContext("2d");k.drawImage(m,-l+1,0);return k.getImageData(0,0,1,1).data[3]===0}else{return false}}return function(n,G,r,q,B,A){var p=G.naturalWidth,v=G.naturalHeight,C=n.getContext("2d"),m=h(G),k=this.type==="image/jpeg",F=1024,w=0,s=0,l,o,D,u,E,z,t;if(m){p/=2;v/=2}C.save();l=document.createElement("canvas");l.width=l.height=F;o=l.getContext("2d");D=k?j(G,p,v):1;u=Math.ceil(F*B/p);E=Math.ceil(F*A/v/D);while(w<v){z=0;t=0;while(z<p){o.clearRect(0,0,F,F);o.drawImage(G,-z,-w);C.drawImage(l,0,0,F,F,r+t,q+s,u,E);z+=F;t+=u}w+=F;s+=E}C.restore();l=o=null}})()})});c("runtime/html5/transport",["base","runtime/html5/runtime"],function(d,g){var e=d.noop,f=d.$;return g.register("Transport",{init:function(){this._status=0;this._response=null},send:function(){var h=this.owner,l=this.options,o=this._initAjax(),k=h._blob,n=l.server,m,p,j;if(l.sendAsBinary){n+=(/\?/.test(n)?"&":"?")+f.param(h._formData);p=k.getSource()}else{m=new FormData();f.each(h._formData,function(r,q){m.append(r,q)});m.append(l.fileVal,k.getSource(),l.filename||h._formData.name||"")}if(l.withCredentials&&"withCredentials" in o){o.open(l.method,n,true);o.withCredentials=true}else{o.open(l.method,n)}this._setRequestHeader(o,l.headers);if(p){o.overrideMimeType&&o.overrideMimeType("application/octet-stream");if(d.os.android){j=new FileReader();j.onload=function(){o.send(this.result);j=j.onload=null};j.readAsArrayBuffer(p)}else{o.send(p)}}else{o.send(m)}},getResponse:function(){return this._response},getResponseAsJson:function(){return this._parseJson(this._response)},getStatus:function(){return this._status},abort:function(){var h=this._xhr;if(h){h.upload.onprogress=e;h.onreadystatechange=e;h.abort();this._xhr=h=null}},destroy:function(){this.abort()
},_initAjax:function(){var j=this,k=new XMLHttpRequest(),h=this.options;if(h.withCredentials&&!("withCredentials" in k)&&typeof XDomainRequest!=="undefined"){k=new XDomainRequest()}k.upload.onprogress=function(m){var l=0;if(m.lengthComputable){l=m.loaded/m.total}return j.trigger("progress",l)};k.onreadystatechange=function(){if(k.readyState!==4){return}k.upload.onprogress=e;k.onreadystatechange=e;j._xhr=null;j._status=k.status;if(k.status>=200&&k.status<300){j._response=k.responseText;return j.trigger("load")}else{if(k.status>=500&&k.status<600){j._response=k.responseText;return j.trigger("error","server")}}return j.trigger("error",j._status?"http":"abort")};j._xhr=k;return k},_setRequestHeader:function(j,h){f.each(h,function(k,l){j.setRequestHeader(k,l)})},_parseJson:function(k){var j;try{j=JSON.parse(k)}catch(h){j={}}return j}})});c("runtime/html5/md5",["runtime/html5/runtime"],function(q){var g=function(w,v){return(w+v)&4294967295},r=function(B,y,w,v,A,z){y=g(g(y,B),g(v,z));return g((y<<A)|(y>>>(32-A)),w)},d=function(y,w,C,B,v,A,z){return r((w&C)|((~w)&B),y,w,v,A,z)},n=function(y,w,C,B,v,A,z){return r((w&B)|(C&(~B)),y,w,v,A,z)},h=function(y,w,C,B,v,A,z){return r(w^C^B,y,w,v,A,z)},t=function(y,w,C,B,v,A,z){return r(C^(w|(~B)),y,w,v,A,z)},f=function(w,z){var y=w[0],v=w[1],B=w[2],A=w[3];y=d(y,v,B,A,z[0],7,-680876936);A=d(A,y,v,B,z[1],12,-389564586);B=d(B,A,y,v,z[2],17,606105819);v=d(v,B,A,y,z[3],22,-1044525330);y=d(y,v,B,A,z[4],7,-176418897);A=d(A,y,v,B,z[5],12,1200080426);B=d(B,A,y,v,z[6],17,-1473231341);v=d(v,B,A,y,z[7],22,-45705983);y=d(y,v,B,A,z[8],7,1770035416);A=d(A,y,v,B,z[9],12,-1958414417);B=d(B,A,y,v,z[10],17,-42063);v=d(v,B,A,y,z[11],22,-1990404162);y=d(y,v,B,A,z[12],7,1804603682);A=d(A,y,v,B,z[13],12,-40341101);B=d(B,A,y,v,z[14],17,-1502002290);v=d(v,B,A,y,z[15],22,1236535329);y=n(y,v,B,A,z[1],5,-165796510);A=n(A,y,v,B,z[6],9,-1069501632);B=n(B,A,y,v,z[11],14,643717713);v=n(v,B,A,y,z[0],20,-373897302);y=n(y,v,B,A,z[5],5,-701558691);A=n(A,y,v,B,z[10],9,38016083);B=n(B,A,y,v,z[15],14,-660478335);v=n(v,B,A,y,z[4],20,-405537848);y=n(y,v,B,A,z[9],5,568446438);A=n(A,y,v,B,z[14],9,-1019803690);B=n(B,A,y,v,z[3],14,-187363961);v=n(v,B,A,y,z[8],20,1163531501);y=n(y,v,B,A,z[13],5,-1444681467);A=n(A,y,v,B,z[2],9,-51403784);B=n(B,A,y,v,z[7],14,1735328473);v=n(v,B,A,y,z[12],20,-1926607734);y=h(y,v,B,A,z[5],4,-378558);A=h(A,y,v,B,z[8],11,-2022574463);B=h(B,A,y,v,z[11],16,1839030562);v=h(v,B,A,y,z[14],23,-35309556);y=h(y,v,B,A,z[1],4,-1530992060);A=h(A,y,v,B,z[4],11,1272893353);B=h(B,A,y,v,z[7],16,-155497632);v=h(v,B,A,y,z[10],23,-1094730640);y=h(y,v,B,A,z[13],4,681279174);A=h(A,y,v,B,z[0],11,-358537222);B=h(B,A,y,v,z[3],16,-722521979);v=h(v,B,A,y,z[6],23,76029189);y=h(y,v,B,A,z[9],4,-640364487);A=h(A,y,v,B,z[12],11,-421815835);B=h(B,A,y,v,z[15],16,530742520);v=h(v,B,A,y,z[2],23,-995338651);y=t(y,v,B,A,z[0],6,-198630844);A=t(A,y,v,B,z[7],10,1126891415);B=t(B,A,y,v,z[14],15,-1416354905);v=t(v,B,A,y,z[5],21,-57434055);y=t(y,v,B,A,z[12],6,1700485571);A=t(A,y,v,B,z[3],10,-1894986606);B=t(B,A,y,v,z[10],15,-1051523);v=t(v,B,A,y,z[1],21,-2054922799);y=t(y,v,B,A,z[8],6,1873313359);A=t(A,y,v,B,z[15],10,-30611744);B=t(B,A,y,v,z[6],15,-1560198380);v=t(v,B,A,y,z[13],21,1309151649);y=t(y,v,B,A,z[4],6,-145523070);A=t(A,y,v,B,z[11],10,-1120210379);B=t(B,A,y,v,z[2],15,718787259);v=t(v,B,A,y,z[9],21,-343485551);w[0]=g(y,w[0]);w[1]=g(v,w[1]);w[2]=g(B,w[2]);w[3]=g(A,w[3])},u=function(w){var x=[],v;for(v=0;v<64;v+=4){x[v>>2]=w.charCodeAt(v)+(w.charCodeAt(v+1)<<8)+(w.charCodeAt(v+2)<<16)+(w.charCodeAt(v+3)<<24)}return x},p=function(v){var x=[],w;for(w=0;w<64;w+=4){x[w>>2]=v[w]+(v[w+1]<<8)+(v[w+2]<<16)+(v[w+3]<<24)}return x},o=function(D){var x=D.length,v=[1732584193,-271733879,-1732584194,271733878],z,w,C,A,B,y;for(z=64;z<=x;z+=64){f(v,u(D.substring(z-64,z)))}D=D.substring(z-64);w=D.length;C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(z=0;z<w;z+=1){C[z>>2]|=D.charCodeAt(z)<<((z%4)<<3)}C[z>>2]|=128<<((z%4)<<3);if(z>55){f(v,C);for(z=0;z<16;z+=1){C[z]=0}}A=x*8;A=A.toString(16).match(/(.*?)(.{0,8})$/);B=parseInt(A[2],16);y=parseInt(A[1],16)||0;C[14]=B;C[15]=y;f(v,C);return v},s=function(D){var x=D.length,v=[1732584193,-271733879,-1732584194,271733878],z,w,C,A,B,y;for(z=64;z<=x;z+=64){f(v,p(D.subarray(z-64,z)))}D=(z-64)<x?D.subarray(z-64):new Uint8Array(0);w=D.length;C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(z=0;z<w;z+=1){C[z>>2]|=D[z]<<((z%4)<<3)}C[z>>2]|=128<<((z%4)<<3);if(z>55){f(v,C);for(z=0;z<16;z+=1){C[z]=0}}A=x*8;A=A.toString(16).match(/(.*?)(.{0,8})$/);B=parseInt(A[2],16);y=parseInt(A[1],16)||0;C[14]=B;C[15]=y;f(v,C);return v},m=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],k=function(x){var w="",v;for(v=0;v<4;v+=1){w+=m[(x>>(v*8+4))&15]+m[(x>>(v*8))&15]}return w},e=function(v){var w;for(w=0;w<v.length;w+=1){v[w]=k(v[w])}return v.join("")},l=function(v){return e(o(v))},j=function(){this.reset()};if(l("hello")!=="5d41402abc4b2a76b9719d911017c592"){g=function(v,A){var z=(v&65535)+(A&65535),w=(v>>16)+(A>>16)+(z>>16);return(w<<16)|(z&65535)
}}j.prototype.append=function(v){if(/[\u0080-\uFFFF]/.test(v)){v=unescape(encodeURIComponent(v))}this.appendBinary(v);return this};j.prototype.appendBinary=function(x){this._buff+=x;this._length+=x.length;var w=this._buff.length,v;for(v=64;v<=w;v+=64){f(this._state,u(this._buff.substring(v-64,v)))}this._buff=this._buff.substr(v-64);return this};j.prototype.end=function(x){var A=this._buff,z=A.length,y,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],v;for(y=0;y<z;y+=1){w[y>>2]|=A.charCodeAt(y)<<((y%4)<<3)}this._finish(w,z);v=!!x?this._state:e(this._state);this.reset();return v};j.prototype._finish=function(w,A){var y=A,x,z,v;w[y>>2]|=128<<((y%4)<<3);if(y>55){f(this._state,w);for(y=0;y<16;y+=1){w[y]=0}}x=this._length*8;x=x.toString(16).match(/(.*?)(.{0,8})$/);z=parseInt(x[2],16);v=parseInt(x[1],16)||0;w[14]=z;w[15]=v;f(this._state,w)};j.prototype.reset=function(){this._buff="";this._length=0;this._state=[1732584193,-271733879,-1732584194,271733878];return this};j.prototype.destroy=function(){delete this._state;delete this._buff;delete this._length};j.hash=function(x,v){if(/[\u0080-\uFFFF]/.test(x)){x=unescape(encodeURIComponent(x))}var w=o(x);return !!v?w:e(w)};j.hashBinary=function(w,v){var x=o(w);return !!v?x:e(x)};j.ArrayBuffer=function(){this.reset()};j.ArrayBuffer.prototype.append=function(v){var y=this._concatArrayBuffer(this._buff,v),x=y.length,w;this._length+=v.byteLength;for(w=64;w<=x;w+=64){f(this._state,p(y.subarray(w-64,w)))}this._buff=(w-64)<x?y.subarray(w-64):new Uint8Array(0);return this};j.ArrayBuffer.prototype.end=function(x){var A=this._buff,z=A.length,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],y,v;for(y=0;y<z;y+=1){w[y>>2]|=A[y]<<((y%4)<<3)}this._finish(w,z);v=!!x?this._state:e(this._state);this.reset();return v};j.ArrayBuffer.prototype._finish=j.prototype._finish;j.ArrayBuffer.prototype.reset=function(){this._buff=new Uint8Array(0);this._length=0;this._state=[1732584193,-271733879,-1732584194,271733878];return this};j.ArrayBuffer.prototype.destroy=j.prototype.destroy;j.ArrayBuffer.prototype._concatArrayBuffer=function(y,w){var x=y.length,v=new Uint8Array(x+w.byteLength);v.set(y);v.set(new Uint8Array(w),x);return v};j.ArrayBuffer.hash=function(v,w){var x=s(new Uint8Array(v));return !!w?x:e(x)};return q.register("Md5",{init:function(){},loadFromBlob:function(x){var v=x.getSource(),y=2*1024*1024,z=Math.ceil(v.size/y),E=0,w=this.owner,B=new j.ArrayBuffer(),D=this,F=v.mozSlice||v.webkitSlice||v.slice,C,A;A=new FileReader();C=function(){var H,G;H=E*y;G=Math.min(H+y,v.size);A.onload=function(I){B.append(I.target.result);w.trigger("progress",{total:x.size,loaded:G})};A.onloadend=function(){A.onloadend=A.onload=null;if(++E<z){setTimeout(C,1)}else{setTimeout(function(){w.trigger("load");D.result=B.end();C=x=v=B=null;w.trigger("complete")},50)}};A.readAsArrayBuffer(F.call(v,H,G))};C()},getResult:function(){return this.result}})});c("runtime/flash/runtime",["base","runtime/runtime","runtime/compbase"],function(f,e,l){var j=f.$,g="flash",h={};function d(){var m;try{m=navigator.plugins["Shockwave Flash"];m=m.description}catch(n){try{m=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(o){m="0.0"}}m=m.match(/\d+/g);return parseFloat(m[0]+"."+m[1],10)}function k(){var p={},n={},o=this.destroy,r=this,m=f.guid("webuploader_");e.apply(r,arguments);r.type=g;r.exec=function(u,x){var t=this,w=t.uid,v=f.slice(arguments,2),s;n[w]=t;if(h[u]){if(!p[w]){p[w]=new h[u](t,r)}s=p[w];if(s[x]){return s[x].apply(s,v)}}return r.flashExec.apply(t,arguments)};function q(s,w){var u=s.type||s,v,t;v=u.split("::");t=v[0];u=v[1];if(u==="Ready"&&t===r.uid){r.trigger("ready")}else{if(n[t]){n[t].trigger(u.toLowerCase(),s,w)}}}b[m]=function(){var s=arguments;setTimeout(function(){q.apply(null,s)},1)};this.jsreciver=m;this.destroy=function(){return o&&o.apply(this,arguments)};this.flashExec=function(s,v){var u=r.getFlash(),t=f.slice(arguments,2);return u.exec(this.uid,s,v,t)}}f.inherits(e,{constructor:k,init:function(){var m=this.getContainer(),o=this.options,n;m.css({position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});n='<object id="'+this.uid+'" type="application/'+'x-shockwave-flash" data="'+o.swf+'" ';if(f.browser.ie){n+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '}n+='width="100%" height="100%" style="outline:0">'+'<param name="movie" value="'+o.swf+'" />'+'<param name="flashvars" value="uid='+this.uid+"&jsreciver="+this.jsreciver+'" />'+'<param name="wmode" value="transparent" />'+'<param name="allowscriptaccess" value="always" />'+"</object>";m.html(n)},getFlash:function(){if(this._flash){return this._flash}this._flash=j("#"+this.uid).get(0);return this._flash}});k.register=function(n,m){m=h[n]=f.inherits(l,j.extend({flashExec:function(){var o=this.owner,p=this.getRuntime();return p.flashExec.apply(o,arguments)}},m));return m};if(d()>=11.4){e.addRuntime(g,k)}return k});c("runtime/flash/filepicker",["base","runtime/flash/runtime"],function(d,f){var e=d.$;return f.register("FilePicker",{init:function(j){var k=e.extend({},j),g,h;
g=k.accept&&k.accept.length;for(h=0;h<g;h++){if(!k.accept[h].title){k.accept[h].title="Files"}}delete k.button;delete k.id;delete k.container;this.flashExec("FilePicker","init",k)},destroy:function(){this.flashExec("FilePicker","destroy")}})});c("runtime/flash/image",["runtime/flash/runtime"],function(d){return d.register("Image",{loadFromBlob:function(f){var e=this.owner;e.info()&&this.flashExec("Image","info",e.info());e.meta()&&this.flashExec("Image","meta",e.meta());this.flashExec("Image","loadFromBlob",f.uid)}})});c("runtime/flash/transport",["base","runtime/flash/runtime","runtime/client"],function(e,g,d){var f=e.$;return g.register("Transport",{init:function(){this._status=0;this._response=null;this._responseJson=null},send:function(){var h=this.owner,k=this.options,m=this._initAjax(),j=h._blob,l=k.server,n;m.connectRuntime(j.ruid);if(k.sendAsBinary){l+=(/\?/.test(l)?"&":"?")+f.param(h._formData);n=j.uid}else{f.each(h._formData,function(p,o){m.exec("append",p,o)});m.exec("appendBlob",k.fileVal,j.uid,k.filename||h._formData.name||"")}this._setRequestHeader(m,k.headers);m.exec("send",{method:k.method,url:l,forceURLStream:k.forceURLStream,mimeType:"application/octet-stream"},n)},getStatus:function(){return this._status},getResponse:function(){return this._response||""},getResponseAsJson:function(){return this._responseJson},abort:function(){var h=this._xhr;if(h){h.exec("abort");h.destroy();this._xhr=h=null}},destroy:function(){this.abort()},_initAjax:function(){var h=this,j=new d("XMLHttpRequest");j.on("uploadprogress progress",function(l){var k=l.loaded/l.total;k=Math.min(1,Math.max(0,k));return h.trigger("progress",k)});j.on("load",function(){var k=j.exec("getStatus"),m=false,l="",n;j.off();h._xhr=null;if(k>=200&&k<300){m=true}else{if(k>=500&&k<600){m=true;l="server"}else{l="http"}}if(m){h._response=j.exec("getResponse");h._response=decodeURIComponent(h._response);n=b.JSON&&b.JSON.parse||function(o){try{return new Function("return "+o).call()}catch(p){return{}}};h._responseJson=h._response?n(h._response):{}}j.destroy();j=null;return l?h.trigger("error",l):h.trigger("load")});j.on("error",function(){j.off();h._xhr=null;h.trigger("error","http")});h._xhr=j;return j},_setRequestHeader:function(j,h){f.each(h,function(k,l){j.exec("setRequestHeader",k,l)})}})});c("runtime/flash/blob",["runtime/flash/runtime","lib/blob"],function(d,e){return d.register("Blob",{slice:function(h,f){var g=this.flashExec("Blob","slice",h,f);return new e(g.uid,g)}})});c("runtime/flash/md5",["runtime/flash/runtime"],function(d){return d.register("Md5",{init:function(){},loadFromBlob:function(e){return this.flashExec("Md5","loadFromBlob",e.uid)}})});c("preset/all",["base","widgets/filednd","widgets/filepaste","widgets/filepicker","widgets/image","widgets/queue","widgets/runtime","widgets/upload","widgets/validator","widgets/md5","runtime/html5/blob","runtime/html5/dnd","runtime/html5/filepaste","runtime/html5/filepicker","runtime/html5/imagemeta/exif","runtime/html5/androidpatch","runtime/html5/image","runtime/html5/transport","runtime/html5/md5","runtime/flash/filepicker","runtime/flash/image","runtime/flash/transport","runtime/flash/blob","runtime/flash/md5"],function(d){return d});c("widgets/log",["base","uploader","widgets/widget"],function(e,l){var h=e.$,k=" http://static.tieba.baidu.com/tb/pms/img/st.gif??",g=(location.hostname||location.host||"protected").toLowerCase(),d=g&&/baidu/i.exec(g),f;if(!d){return}f={dv:3,master:"webuploader",online:/test/.exec(g)?0:1,module:"",product:g,type:0};function j(n){var p=h.extend({},f,n),m=k.replace(/^(.*)\?/,"$1"+h.param(p)),o=new Image();o.src=m}return l.register({name:"log",init:function(){var m=this.owner,o=0,n=0;m.on("error",function(p){j({type:2,c_error_code:p})}).on("uploadError",function(p,q){j({type:2,c_error_code:"UPLOAD_ERROR",c_reason:""+q})}).on("uploadComplete",function(p){o++;n+=p.size}).on("uploadFinished",function(){j({c_count:o,c_size:n});o=n=0});j({c_usage:1})}})});c("webuploader",["preset/all","widgets/log"],function(d){return d});return a("webuploader")});